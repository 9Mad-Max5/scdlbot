os: linux
language: python
python:
- 3.5
- 3.6
- 3.7
- 3.8

before_install:
- pip install --upgrade pip
- pip install poetry
install:
- poetry install -v
- pip install --upgrade tox-travis
script: tox

before_deploy:
- pip install --upgrade pip
- pip install poetry
deploy:
  provider: script
  script:
  - poetry publish --build --username ${PYPI_USER} --password ${PYPI_PASSWORD}
  on:
    tags: true
    python: 3.8
